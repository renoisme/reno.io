<!DOCTYPE html>
<html>

<head>
    <title>SCN Project</title>
    <link rel="icon"
        href="https://raw.githubusercontent.com/SCN-Project/Logo-Data/9862fc9e514e05e717863c5054b2801e8f258974/PNG/Type-1%202.svg">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f0f0;
        }

        #qr-input {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            width: 80%;
            max-width: 300px;
            font-size: 16px;
        }

        #button-container {
            display: flex;
            margin-top: 10px;
        }

        #generate-button {
            flex: 1;
            padding: 20px 40px;
            border-radius: 5px;
            border: none;
            background-color: #007BFF;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #download-button,
        #close-button {
            flex: 1;
            padding: 20px 30px;
            border-radius: 5px;
            border: none;
            background-color: #007BFF;
            color: white;
            font-size: 15px;
            transition: background-color 0.3s;
            display: none;
            cursor: pointer;
            white-space: nowrap;
        }

        #qr-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        #qr-result {
            transform: scaleX(-1);
        }

        select {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            width: 80%;
            max-width: 300px;
            font-size: 16px;
        }

        #home-button {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: #007BFF;
            border: none;
            cursor: pointer;
            padding: 20px;
            border-radius: 5px;
            color: white;
        }

        label,
        select {
            margin: 10px 0;
        }

        .loader,
        .loader:before,
        .loader:after {
            border-radius: 50%;
            width: 2.5em;
            height: 2.5em;
            -webkit-animation-fill-mode: both;
            animation-fill-mode: both;
            -webkit-animation: load7 1.8s infinite ease-in-out;
            animation: load7 1.8s infinite ease-in-out;
        }

        .loader {
            color: #000;
            font-size: 10px;
            margin: 80px auto;
            position: relative;
            text-indent: -9999em;
            -webkit-transform: translateZ(0);
            -ms-transform: translateZ(0);
            transform: translateZ(0);
            -webkit-animation-delay: -0.16s;
            animation-delay: -0.16s;
        }

        .loader:before,
        .loader:after {
            content: '';
            position: absolute;
            top: 0;
        }

        .loader:before {
            left: -3.5em;
            -webkit-animation-delay: -0.32s;
            animation-delay: -0.32s;
        }

        .loader:after {
            left: 3.5em;
        }

        @-webkit-keyframes load7 {

            0%,
            80%,
            100% {
                box-shadow: 0 2.5em 0 -1.3em;
            }

            40% {
                box-shadow: 0 2.5em 0 0;
            }
        }

        @keyframes load7 {

            0%,
            80%,
            100% {
                box-shadow: 0 2.5em 0 -1.3em;
            }

            40% {
                box-shadow: 0 2.5em 0 0;
            }
        }

        @keyframes rotate {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <button id="home-button" onclick="window.location.href='index.html'">ホームに戻る</button>
    <input type="text" id="qr-input" placeholder="テキストを入力してQRコードを生成">
    <div id="button-container">
        <button id="generate-button">QRコードを作成</button>
    </div>
    <label for="qr-size">QRコードのサイズ設定</label>
    <select id="qr-size">
        <option value="100">小さい</option>
        <option value="200">普通</option>
        <option value="300">大きい</option>
    </select>
    <div id="qr-container">
        <div id="qr-result">
            <img id="qr-img">
        </div>
    </div>
    <div id="button-container" style="display: flex; justify-content: center;">
        <button id="download-button" style="display: none;">保 存 </button>
        <button id="close-button" style="display: none;">閉じる</button>
    </div>

    <div id="loading" style="display: none;">
        <div class="loader">Loading...</div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        let rotation = 0;
        let loadingImage = $('#loading-image');

        function rotateLoadingImage() {
            rotation += 90;
            loadingImage.css({
                transform: 'rotate(' + rotation + 'deg)'
            });
        }
        $(document).ready(function () {
            $('#generate-button').click(function () {
                let inputVal = $('#qr-input').val();
                if (inputVal == 0) return;
                let qrSize = $('#qr-size').val();
                $('#loading').show();

                $('#loader').show();
                let intervalId = setInterval(rotateLoadingImage, 10);
                $('#qr-img').remove();
                let img = $('<img />', {
                    id: 'qr-img',
                    src: 'https://api.qrserver.com/v1/create-qr-code/?data=' + inputVal + '&size=' + qrSize + 'x' + qrSize,
                    alt: ''
                });

                img.on('load', function () {

                    $('#loading').hide();
                    clearInterval(intervalId);
                    img.appendTo('#qr-result');
                    $('#close-button').show();
                    $('#download-button').show().attr('href', img.attr('src'));
                });
            });
            $('#download-button').click(function () {
                let qrImgSrc = $('#qr-img').attr('src');
                let a = document.createElement('a');
                a.href = qrImgSrc;
                a.download = 'qr-code.png';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });

            $('#close-button').click(function () {
                $('#qr-img').remove();
                $('#download-button').hide();
                $('#close-button').hide();
            });
        });

    </script>
</body>

</html>
